<workflowGraph name="">
    <param name="abbrev"/>
    <param name="orthomclClade"/>
    <param name="oldAbbrevsList"/>
    <param name="oldReleasesSequenceFilesDir"/>
    <param name="oldReleasesGroupFilesDir"/>
    <param name="residualFastaFilesDir"/>
    <param name="proteomeDatasetsDir"/>
    <param name="datasetName"/>

    <step name="mapPreviousSeqIDs" stepClass="OrthoMCLWorkflow::Main::WorkflowSteps::MapAndInsertPrevSeqIDs">
      <paramValue name="abbrev">$$abbrev$$</paramValue>
      <paramValue name="oldAbbrevsList">$$oldAbbrevsList$$</paramValue>
      <paramValue name="inputDir">$$oldReleasesSequenceFilesDir$$</paramValue>
    </step>

    <step name="mapPreviousGroupIDs" stepClass="OrthoMCLWorkflow::Main::WorkflowSteps::MapAndInsertPrevGroupIDs">
      <paramValue name="abbrev">$$abbrev$$</paramValue>
      <paramValue name="oldAbbrevsList">$$oldAbbrevsList$$</paramValue>
      <paramValue name="inputDir">$$oldReleasesGroupFilesDir$$</paramValue>
      <depends name="mapPreviousSeqIDs"/>
    </step>

  <step name="mirrorProteomeDirToCluster" stepClass="ReFlow::StepClasses::MirrorToComputeCluster">
    <paramValue name="fileOrDirToMirror">$$proteomeDatasetsDir$$/$$datasetName$$</paramValue>
  </step>

  <step name="mirrorFastaFileToCluster" stepClass="ReFlow::StepClasses::MirrorToComputeCluster">
    <paramValue name="fileOrDirToMirror">$$proteomeDatasetsDir$$/$$datasetName$$/$$abbrev$$.fasta</paramValue>
    <depends name="mirrorProteomeDirToCluster"/>
  </step>

  <step name="makeInterproDir" stepClass="ReFlow::StepClasses::MakeDataDir">
    <paramValue name="dataDir">$$proteomeDatasetsDir$$/$$datasetName$$/Interpro</paramValue>
    <depends name="mirrorFastaFileToCluster"/>
  </step>

  <step name="mirrorInterproDirToCluster" stepClass="ReFlow::StepClasses::MirrorToComputeCluster">
    <paramValue name="fileOrDirToMirror">$$proteomeDatasetsDir$$/$$datasetName$$/Interpro</paramValue>
    <depends name="makeInterproDir"/>
  </step>
  
  <subgraph name="InterproScan" xmlFile="interpro.xml">
    <paramValue name="proteinsFile">$$proteomeDatasetsDir$$/$$datasetName$$/$$abbrev$$.fasta</paramValue>
    <paramValue name="parentDataDir">$$proteomeDatasetsDir$$/$$datasetName$$/Interpro</paramValue>
    <paramValue name="insertVersion">2</paramValue>
    <paramValue name="aaSeqTable">ExternalAASequence</paramValue>
    <paramValue name="sourceIdRegex">^\w+\|(\S+)</paramValue>
    <depends name="mirrorInterproDirToCluster"/>    
  </subgraph>

</workflowGraph>
